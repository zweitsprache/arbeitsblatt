generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Folder {
  id         String      @id @default(cuid())
  name       String
  parentId   String?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  userId     String?
  parent     Folder?     @relation("FolderTree", fields: [parentId], references: [id], onDelete: Cascade)
  children   Folder[]    @relation("FolderTree")
  worksheets Worksheet[]

  @@index([parentId])
  @@index([userId])
}

model Worksheet {
  id          String   @id @default(cuid())
  title       String   @default("Untitled Worksheet")
  description String?
  slug        String   @unique
  blocks      Json     @default("[]")
  settings    Json     @default("{}")
  published   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  folderId    String?
  userId      String?
  folder      Folder?  @relation(fields: [folderId], references: [id])

  @@index([slug])
  @@index([folderId])
  @@index([userId])
}

model EBook {
  id            String   @id @default(cuid())
  title         String   @default("Untitled E-Book")
  slug          String   @unique
  chapters      Json     @default("[]")  // Array of EBookChapter objects
  coverSettings Json     @default("{}")  // EBookCoverSettings
  settings      Json     @default("{}")  // EBookSettings
  published     Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  folderId      String?
  userId        String?

  @@index([slug])
  @@index([folderId])
  @@index([userId])
}
